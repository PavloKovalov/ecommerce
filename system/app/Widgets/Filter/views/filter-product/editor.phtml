<div class="plugin-filtering-widget plugin-filtering-wrap" data-filterid="<?php echo $this->filterId; ?>">
    <h4><?php echo $this->translate('Filter Widget Builder'); ?><br/>
        <p style="font-size: 80%">!!! <?php echo $this->translate('Checked filters will not be displayed to users'); ?>
            !!!</p>
    </h4>
    <ul>
    <?php if (!empty($this->tags)) : ?>
        <li>
            <label class="filter-label">
                <input type="checkbox" name="hide[tags]"
                       value="all"
                        <?php if (isset($this->settings['tags']) && $this->settings['tags'] === 'all' ): ?>
                       checked
                        <?php endif; ?>
                    />
                <?php echo $this->translate('Category');?>
            </label>
            <ul>
                <?php foreach ($this->tags as $tag) :?>
                <li>
                    <label>
                        <input type="checkbox" name="hide[tags][]"
                               value="<?php echo $tags['id']; ?>"
                                <?php if (isset($this->settings['tags'])
                                && is_array($this->setting['tags'])
                                && in_array($tag['id'], $this->settings['tags'])) :?>
                               checked
                                <?php endif; ?>
                            />
                        <?php echo $tag['name']; ?>
                    </label></li>
                <?php endforeach; ?>
            </ul>
        </li>
    <?php endif; ?>
    <?php if (!empty($this->brands)) : ?>
        <li>
            <label class="filter-label">
                <input type="checkbox" name="hide[brands]"
                       value="all"
                        <?php if (isset($this->settings['brands'])
                            && $this->settings['brands'] === 'all' ): ?>
                       checked
                        <?php endif; ?>
                    />
                <?php echo $this->translate('Brands');?>
            </label>
            <ul>
                <?php foreach ($this->brands as $brand) :?>
                <li>
                    <label>
                        <input type="checkbox" name="hide[brands][]"
                               value="<?php echo $brand['id']; ?>"
                                <?php if (isset($this->settings['brands'])
                                && is_array($this->setting['brands'])
                                && in_array($brand['id'], $this->settings['brands'])) :?>
                               checked
                                <?php endif; ?>
                            />
                        <?php echo $brand['name']; ?>
                    </label></li>
                <?php endforeach; ?>
            </ul>
        </li>
    <?php endif; ?>
    <?php if ($this->priceRange) :?>
        <?php
        $priceRange = array(
            'min' => (empty($this->priceRange['from']) ? $this->priceRange['min'] : $this->priceRange['from']),
            'max' => (empty($this->priceRange['to']) ? $this->priceRange['max'] : $this->priceRange['to'])
        );
        ?>
        <li class="filter-price">
            <label class="filter-label">
                <input type="checkbox" name="hide[price]"
                       value="all"
                        <?php if (!empty($this->settings['price'])): ?>
                       checked
                        <?php endif; ?>
                    />
                <?php echo $this->translate('Price'); ?>
            </label>
            <label><?php echo $this->translate('From'); ?></label>
            <input type="text" class="price-field price-min" value="<?php echo $priceRange['min'] ?>"/>
            <label><?php echo $this->translate('To'); ?></label>
            <input type="text" class="price-field price-max" value="<?php echo $priceRange['max']; ?>"/>
            <input type="hidden" name="price" value="<?php echo implode('-', $priceRange); ?>"/>
        </li>
    <?php endif; ?>
    <?php foreach ($this->filters as $filterId => $filter) : ?>
        <li data-attributeId="<?php echo $filterId; ?>">
            <label class="filter-label">
                <?php
                echo $this->formCheckbox(
                    'hide[' . $filter['attribute_id'] . ']',
                    (array_key_exists($filterId, $this->settings) && $this->settings[$filterId] === '1'),
                    array(
                        'title' => $this->translate('Check to hide from users'),
                        'class' => 'filter-cb'
                    ),
                    array(
                        'checked'   => true,
                        'unChecked' => false
                    )
                );
                echo $filter['label'];
                ?>
            </label>
            <ul>
                <?php $values = array_unique($filter['value']); ?>
                <?php foreach ($values as $value) : ?>
                    <li>
                        <label>
                            <?php
                            $checked = false;
                            $disabled = false;
                            if (isset($this->settings[$filterId])) {
                                if ($this->settings[$filterId] === '1') {
                                    $checked = $value;
                                    $disabled = true;
                                } elseif (is_array($this->settings[$filterId]) && in_array(
                                        $value,
                                        $this->settings[$filterId]
                                    )
                                ) {
                                    $checked = $value;
                                }
                            }
                            echo $this->formCheckbox(
                                'hide[' . $filter['attribute_id'] . '][]',
                                $checked,
                                array(
                                    'title'   => $this->translate('Check to hide from users'),
                                    'disable' => $disabled
                                ),
                                array(
                                    'checked'   => $value,
                                    'unChecked' => false
                                )
                            );
                            echo $value;
                            ?></label>
                    </li>
                <?php endforeach; ?>
            </ul>
        </li>
    <?php endforeach; ?>
    </ul>
    <div class="footer">
        <button type="submit"><?php echo $this->translate('Save'); ?></button>
    </div>
</div>

<style type="text/css">
    .plugin-filtering-widget ul {
        margin: 0 0 0 10px;
        padding: 5px;
    }

    .plugin-filtering-widget ul li {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .plugin-filtering-widget > ul > li:nth-child(odd) {
        background-color: #eee;
    }

    .plugin-filtering-widget ul label.filter-label {
        font-weight: bold;
        cursor: pointer;
    }

    .plugin-filtering-wrap {
        width: auto;
        overflow: hidden;
        position: relative;
        border: 3px dashed #eee;
    }

    .plugin-filtering-wrap > h4 {
        border-bottom: 3px dashed #eee;
        padding: 3px;
        text-transform: uppercase;
    }

    .plugin-filtering-wrap > h4 > span {
        font-size: 80%;
    }

    .plugin-filtering-wrap > .footer {
        border-top: 3px dashed #eee;
    }
</style>